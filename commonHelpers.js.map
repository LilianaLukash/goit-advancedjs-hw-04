{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst apiKey = \"45272340-7dc1a3d2f1c55d3a20037b43c\"\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n  const params = {\n    key: apiKey,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: perPage,\n  };\n\n  try {\n      const response = await axios.get(BASE_URL, { params });\n      console.log(response.data);\n    return response.data;\n  } catch (error) {\n    console.error('Ошибка при выполнении запроса:', error);\n    throw error;\n  }\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nexport function renderGallery(images) {\n  const gallery = document.querySelector(\".gallery\");\n   const markup = images.map(image => `\n    <div class=\"photo-card\">\n      <a href=\"${image.largeImageURL}\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n      </a>\n      <div class=\"info\">\n        <p class=\"info-item\">Likes: ${image.likes}</p>\n        <p class=\"info-item\">Views: ${image.views}</p>\n        <p class=\"info-item\">Comments: ${image.comments}</p>\n        <p class=\"info-item\">Downloads: ${image.downloads}</p>\n      </div>\n    </div>\n  `).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  let lightbox = new SimpleLightbox('.gallery a');\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  const gallery = document.querySelector('.gallery');\n  gallery.innerHTML = '';\n}","import { fetchImages } from './js/pixabay-api';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { renderGallery, clearGallery } from './js/render-functions';\n\nconst form = document.querySelector('.search-form');\nconst loadMoreBtn = document.querySelector('#load-more-btn');\nconst messageBox = document.querySelector('#message-box');\nconst loader = document.querySelector('.loader');\n\nlet searchQuery = '';\nlet currentPage = 1;\nlet totalHits = 0; // Добавляем переменную для отслеживания общего количества найденных изображений\n\nform.addEventListener('submit', onSearch);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\n\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\n\nfunction showMessage(message) {\n  messageBox.textContent = message;\n  messageBox.classList.remove('hidden');\n}\n\nfunction hideMessage() {\n  messageBox.classList.add('hidden');\n}\n\nasync function onSearch(event) {\n  event.preventDefault();\n  searchQuery = event.currentTarget.elements.query.value.trim();\n  currentPage = 1;\n  hideMessage(); // Скрываем сообщение перед новым запросом\n\n  if (searchQuery === '') {\n    return;\n  }\n\n  clearGallery();\n  loadMoreBtn.classList.add('hidden');\n  showLoader();\n\n  try {\n    const data = await fetchImages(searchQuery, currentPage);\n    hideLoader();\n    totalHits = data.totalHits; // Сохраняем общее количество найденных изображений\n\n    if (totalHits === 0) {\n      showMessage('No images found. Please try another query.');\n      return;\n    }\n\n    renderGallery(data.hits);\n    if (data.hits.length > 0 && currentPage * data.hits.length < totalHits) {\n      loadMoreBtn.classList.remove('hidden');\n    }\n    currentPage++;\n    \n  } catch (error) {\n    hideLoader();\n    showMessage('An error occurred while fetching images.');\n  }\n}\n\nasync function onLoadMore() {\n  showLoader();\n\n  try {\n    const data = await fetchImages(searchQuery, currentPage);\n    hideLoader();\n\n    if (data.hits.length === 0 || currentPage * data.hits.length >= totalHits) {\n      loadMoreBtn.classList.add('hidden');\n      showMessage(\"We're sorry, but you've reached the end of search results.\");\n      return;\n    }\n\n    renderGallery(data.hits);\n    currentPage++;\n    \n\n    // Прокрутка страницы\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    hideLoader();\n    showMessage('An error occurred while fetching more images.');\n  }\n}"],"names":["apiKey","BASE_URL","fetchImages","query","page","perPage","params","response","axios","error","renderGallery","images","gallery","markup","image","SimpleLightbox","clearGallery","form","loadMoreBtn","messageBox","loader","searchQuery","currentPage","totalHits","onSearch","onLoadMore","showLoader","hideLoader","showMessage","message","hideMessage","event","data","cardHeight"],"mappings":"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"}